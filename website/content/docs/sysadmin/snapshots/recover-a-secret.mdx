---
layout: docs
page_title: Manage snapshots
description: >-
  Save and restore data from cluster snapshots.
---

# Recover discrete secrets from a snapshot

@include 'alerts/enterprise-only.mdx'

Vault Enterprise features a flexible, robust, and delegatable recovery mechanism
for restoring deleted or mistakenly changed secrets that prioritizes Vault
cluster availability. 

Secret recovery lets you recover of specific individual secrets from a cluster
snapshot without restoring the complete cluster state or negatively impacting
the Vault cluster.

You can use secret recovery with the following secrets engines:

- [Cubbyhole](/vault/docs/secrets/cubbyhole)
- [KV secrets engine - version 1](/vault/docs/secrets/kv/kv-v1)

@include 'recover/deletedmounts.mdx'

## Before you start 

- BLAH


## Restore secrets to a single cluster

Recover and restore a secret from a snapshot to a single cluster.

<Tabs>

<Tab heading="CLI" group="cli">

Load the snapshot that holds the secret you need to recover. Note that you load snapshots differently based on whether you use automated snapshots.

@include 'recover/loadedsnapshots.mdx'

Before you can load a manual snapshot, you must transfer the snapshot file from secure storage to a system with access to the cluster.

#### Load a manual snapshot without automated snapshots

Load a manually-saved snapshot.

```shell-session
$ vault operator raft snapshot load backup.snap
```

Vault returns information about the snapshot, including a `snapshot_id` value that you can use to perform further operations with the snapshot and the snapshot status.

<CodeBlockConfig hideClipboard>

```plaintext
Key                                   Value
---                                   -----
cluster_id                            990195d2-9f10-4e5c-84c5-543b4c250dc6
expires_at                            2025-06-14T09:00:00.675319+05:00
snapshot_id                           e57cd0cf-c3fa-4e5e-96ea-4a68fa8f3269
status                                loading
```

</CodeBlockConfig>

Learn more in the [CLI documentation](/vault/docs/commands/operator/raft#snapshot-load).

#### Load an automated snapshot 

When you use Vault Enterprise with automated snapshots, you don't need to first transfer the snapshot file. You can load a snapshot that Vault saved to cloud storage directly from its URL.

```shell-session
$ vault operator raft snapshot load \
    auto_config_name=paris-primary \
    url="https://bucket.example.com/vault-snapshots/primary/paris-backup.snap"
```

Vault returns information about the snapshot, including a `snapshot_id` value that you can use to perform further operations with the snapshot.
<CodeBlockConfig hideClipboard>

```plaintext
Key                                   Value
---                                   -----
auto_config_name                      paris-primary
cluster_id                            7430fa38-8fb6-4b35-b2a7-27ed4c831a44
expires_at                            2025-07-16T03:24:42.867531+05:00
snapshot_id                           9465df92-8236-4af9-8cc8-b7460d882e41
status                                loading
```

</CodeBlockConfig>

Learn more in the [CLI documentation](/vault/docs/commands/operator/raft#snapshot-load).

After you start the snapshot load, you can check the snapshot loading status by reading the snapshot ID returned in the load output.

```shell-session
$ vault read \
    /sys/storage/raft/snapshot-load/9465df92-8236-4af9-8cc8-b7460d882e41
```

Vault responds with snapshot details, including the status.

<CodeBlockConfig hideClipboard>

```plaintext
Key                                   Value
---                                   -----
auto_config_name                      paris-primary
cluster_id                            7430fa38-8fb6-4b35-b2a7-27ed4c831a44
expires_at                            2025-07-16T03:24:42.867531+05:00
snapshot_id                           9465df92-8236-4af9-8cc8-b7460d882e41
status                                ready
```

</CodeBlockConfig>

When Vault loads the snapshot, the status value is `loading` until loading is complete, and the value changes to `ready` when you can use the snapshot for secret recovery.

If a problem occurs during loading, Vault sets the status to `error` and shares details about the problem.

<Note>

You can't recover secrets from a snapshot with an `error` status.

</Note>

#### Recover the secret

When the snapshot status is **ready**, you can recover the secret by specifying its path. 

Your Vault token must have the `recover` capability on a path to recover that path from a snapshot. For example to recover any secret on the path `telemetry-systems`, your token needs an access control list policy like this example:

```hcl
path "telemetry-systems/*" {
  capabilities = ["recover"]
}
```

In this example, recover the secret named `api-key` from the key/value version 1 secrets engine enabled at the path `telemetry-systems`.

```shell-session
$ vault read \
    -snapshot-id 9465df92-8236-4af9-8cc8-b7460d882e41s \
    telemetry-systems/api-key
```

Vault reads the secret at the specified path from the snapshot, then sends that data to the secrets engine to recover the secret. The secrets engine uses this data potientally with its own information to create or update the data at the specified path in live cluster storage.

You can read the secret from its usual path in the secrets engine to test recovery.

```shell-session
$ vault kv get telemetry-systems/api-key
```

Vault responds with the secret data.

<CodeBlockConfig hideClipboard>

```plaintext
=== Data ===
Key    Value
---    -----
key    9C016BB3-F574-4A24-B8A7-8CE1F1CE2128
```

</CodeBlockConfig>

</Tab>

<Tab heading="API" group="api">

Load a **manual snapshot** without automated snapshots.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data-binary @backup.snap \
    https://127.0.0.1:8200/v1/sys/storage/raft/snapshot-load
```

Vault responds with details about the snapshot:

<CodeBlockConfig hideClipboard>

```json
{
  "data": {
    "cluster_id": "990195d2-9f10-4e5c-84c5-543b4c250dc6",
    "expires_at": "2025-06-14T09:00:00.675319+05:00",
    "snapshot_id": "e57cd0cf-c3fa-4e5e-96ea-4a68fa8f3269",
    "status": "loading"
  }
}
```

</CodeBlockConfig>

Load an **automated snapshot**.

When you use Vault Enterprise with automated snapshots, you don't need to first transfer the snapshot file. You can load a snapshot that Vault saved to cloud storage directly from its URL. 

Create a JSON payload that defines the URL to the automated snapshot you need to load.

```shell-session
$ cat > payload.json << EOF
{
  "url": "https://bucket.example.com/vault-snapshots/primary/paris-backup.snap"
}
```

Load the snapshot that holds the secret you need to recover.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    https://127.0.0.1:8200/v1/sys/storage/raft/snapshot-auto/snapshot-load/paris-primary
```

Vault responds with snapshot details, including the status.

```json
{
  "data": {
    "auto_config_name": "paris-primary",
    "cluster_id": "7430fa38-8fb6-4b35-b2a7-27ed4c831a44",
    "expires_at": "2025-07-16T03:24:42.867531+05:00",
    "snapshot_id": "9465df92-8236-4af9-8cc8-b7460d882e41",
    "url": "https://bucket.example.com/vault-snapshots/primary/paris-backup.snap",
    "status": "loading"
  }
}
```

After you start the snapshot load, you can check the snapshot loading status by reading the snapshot ID returned in the load output.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    http://127.0.0.1:8200/v1/sys/storage/raft/snapshot-load/9465df92-8236-4af9-8cc8-b7460d882e41
```

Vault responds with snapshot details, including the status.

```json
{
  "data": {
    "auto_config_name": "paris-primary",
    "cluster_id": "7430fa38-8fb6-4b35-b2a7-27ed4c831a44",
    "expires_at": "2025-07-16T03:24:42.867531+05:00",
    "snapshot_id": "9465df92-8236-4af9-8cc8-b7460d882e41",
    "url": "https://bucket.example.com/vault-snapshots/primary/paris-backup.snap",
    "status": "ready"
  }
}
```

When Vault loads the snapshot, the status value is `loading` until loading is complete, and the value changes to `ready` when you can use the snapshot for secret recovery.

If a problem occurs during loading, Vault sets the status to `error` and shares details about the problem.

<Note>

You can't recover secrets from a snapshot with an `error` status.

</Note>

#### Recover the secret

When the snapshot status is **ready**, you can recover the secret by specifying its path. 

Your Vault token must have the `recover` capability on a path to recover that path from a snapshot. For example to recover any secret on the path `telemetry-systems`, your token needs an access control list policy like this example:

```hcl
path "telemetry-systems/*" {
  capabilities = ["recover"]
}
```

In this example, recover the secret named `api-key` from the key/value version 1 secrets engine enabled at the path `telemetry-systems`.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    https://127.0.0.1:8200/v1/telemetry-systems/api-key?recover_snapshot_id=9465df92-8236-4af9-8cc8-b7460d882e41
```

Vault reads the secret at the specified path from the snapshot, then sends that data to the secrets engine to recover the secret. The secrets engine uses this data potientally with its own information to create or update the data at the specified path in live cluster storage.

You can read the secret from its usual path in the secrets engine to test recovery.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request GET \
    https://127.0.0.1:8200/v1/telemetry-systems/api-key
```

Vault responds with the secret data.

```json
{
    "request_id": "689b2708-fe46-4ee6-0f1a-830f4d3acce0",
    "lease_id": "",
    "renewable": false,
    "lease_duration": 2764800,
    "data": {
        "key": "9C016BB3-F574-4A24-B8A7-8CE1F1CE2128"
    },
    "wrap_info": null,
    "warnings": null,
    "auth": null,
    "mount_type": "kv"
}
```

</Tab>

</Tabs>


## Restore secrets to a DR replication cluster

Loading and recovering secrets from a DR replication snapshot is a workflow similar to that of the single cluster workflow, but with some caveats:

- You must load the snapshot on the primary cluster. 
- You cannot load snapshots on secondary clusters.

These examples show how to recover a secret from a snapshot to a DR Replication cluster using automated snapshots and the Vault CLI or API.

<Tabs>

<Tab heading="CLI" group="cli">

Load the automated snapshot that holds the secret you need to recover on the **primary** cluster.

```shell-session
$ vault operator raft snapshot load \
    auto_config_name=paris-primary \
    url="https://bucket.example.com/vault-snapshots/primary/paris-backup.snap"
```

Vault returns information about the snapshot, including a `snapshot_id` value that you can use to perform further operations with the snapshot.

```plaintext
Key                                   Value
---                                   -----
auto_config_name                      paris-primary
cluster_id                            7430fa38-8fb6-4b35-b2a7-27ed4c831a44
expires_at                            2025-07-16T03:24:42.867531+05:00
snapshot_id                           9465df92-8236-4af9-8cc8-b7460d882e41
status                                loading
```

Learn more in the [CLI documentation](/vault/docs/commands/operator/raft#snapshot-load).

After you start the snapshot load, you can check the snapshot loading status by reading the snapshot ID returned in the load output.

```shell-session
$ vault read \
    /sys/storage/raft/snapshot-load/9465df92-8236-4af9-8cc8-b7460d882e41
```

Vault responds with snapshot details, including the status.

```plaintext
Key                                   Value
---                                   -----
auto_config_name                      paris-primary
cluster_id                            7430fa38-8fb6-4b35-b2a7-27ed4c831a44
expires_at                            2025-07-16T03:24:42.867531+05:00
snapshot_id                           9465df92-8236-4af9-8cc8-b7460d882e41
status                                ready
```

When Vault loads the snapshot, the status value is `loading` until loading is complete, and the value changes to `ready` when you can use the snapshot for secret recovery.

If a problem occurs during loading, Vault sets the status to `error` and shares details about the problem.

<Note>

You can't recover secrets from a snapshot with an `error` status.

</Note>

#### Recover the secret

When the snapshot status is **ready**, you can recover the secret by specifying its path. 

Your Vault token must have the `recover` capability on a path to recover that path from a snapshot. For example to recover any secret on the path `telemetry-systems`, your token needs an access control list policy like this example:

```hcl
path "telemetry-systems/*" {
  capabilities = ["recover"]
}
```

In this example, recover the secret named `api-key` from the key/value version 1 secrets engine enabled at the path `telemetry-systems`.

```shell-session
$ vault read \
    -snapshot-id 9465df92-8236-4af9-8cc8-b7460d882e41s \
    telemetry-systems/api-key
```

Vault reads the secret at the specified path from the snapshot, then sends that data to the secrets engine to recover the secret. The secrets engine uses this data potientally with its own information to create or update the data at the specified path in live cluster storage.

You can read the secret from its usual path in the secrets engine to test recovery.

```shell-session
$ vault kv get telemetry-systems/api-key
```

Vault responds with the secret data.

```plaintext
=== Data ===
Key    Value
---    -----
key    9C016BB3-F574-4A24-B8A7-8CE1F1CE2128
```

</Tab>

<Tab heading="API" group="api">

When you use Vault Enterprise with automated snapshots, you don't need to first transfer the snapshot file. You can load a snapshot that Vault saved to cloud storage directly from its URL. 

Create a JSON payload that defines the URL to the automated snapshot you need to load.

```shell-session
$ cat > payload.json << EOF
{
  "url": "https://bucket.example.com/vault-snapshots/primary/paris-backup.snap"
}
```

Load the snapshot that holds the secret you need to recover.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    https://127.0.0.1:8200/v1/sys/storage/raft/snapshot-auto/snapshot-load/paris-primary
```

Vault responds with snapshot details, including the status.

```json
{
  "data": {
    "auto_config_name": "paris-primary",
    "cluster_id": "7430fa38-8fb6-4b35-b2a7-27ed4c831a44",
    "expires_at": "2025-07-16T03:24:42.867531+05:00",
    "snapshot_id": "9465df92-8236-4af9-8cc8-b7460d882e41",
    "url": "https://bucket.example.com/vault-snapshots/primary/paris-backup.snap",
    "status": "loading"
  }
}
```

After you start the snapshot load, you can check the snapshot loading status by reading the snapshot ID returned in the load output.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    http://127.0.0.1:8200/v1/sys/storage/raft/snapshot-load/9465df92-8236-4af9-8cc8-b7460d882e41
```

Vault responds with snapshot details, including the status.

<CodeBlockConfig hideClipboard>

```json
{
  "data": {
    "auto_config_name": "paris-primary",
    "cluster_id": "7430fa38-8fb6-4b35-b2a7-27ed4c831a44",
    "expires_at": "2025-07-16T03:24:42.867531+05:00",
    "snapshot_id": "9465df92-8236-4af9-8cc8-b7460d882e41",
    "url": "https://bucket.example.com/vault-snapshots/primary/paris-backup.snap",
    "status": "ready"
  }
}
```

</CodeBlockConfig>

When Vault loads the snapshot, the status value is `loading` until loading is complete, and the value changes to `ready` when you can use the snapshot for secret recovery.

If a problem occurs during loading, Vault sets the status to `error` and shares details about the problem.

<Note>

You can't recover secrets from a snapshot with an `error` status.

</Note>

#### Recover the secret

When the snapshot status is **ready**, you can recover the secret by specifying its path. 

Your Vault token must have the `recover` capability on a path to recover that path from a snapshot. For example to recover any secret on the path `telemetry-systems`, your token needs an access control list policy like this example:

```hcl
path "telemetry-systems/*" {
  capabilities = ["recover"]
}
```

In this example, recover the secret named `api-key` from the key/value version 1 secrets engine enabled at the path `telemetry-systems`.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    https://127.0.0.1:8200/v1/telemetry-systems/api-key?recover_snapshot_id=9465df92-8236-4af9-8cc8-b7460d882e41
```

Vault reads the secret at the specified path from the snapshot, then sends that data to the secrets engine to recover the secret. The secrets engine uses this data potientally with its own information to create or update the data at the specified path in live cluster storage.

You can read the secret from its usual path in the secrets engine to test recovery.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request GET \
    https://127.0.0.1:8200/v1/telemetry-systems/api-key
```

Vault responds with the secret data.

<CodeBlockConfig hideClipboard>

```json
{
    "request_id": "689b2708-fe46-4ee6-0f1a-830f4d3acce0",
    "lease_id": "",
    "renewable": false,
    "lease_duration": 2764800,
    "data": {
        "key": "9C016BB3-F574-4A24-B8A7-8CE1F1CE2128"
    },
    "wrap_info": null,
    "warnings": null,
    "auth": null,
    "mount_type": "kv"
}
```

</CodeBlockConfig>

</Tab>

</Tabs>



## Restore secrets to a performance replication cluster

Loading and recovering secrets from a Performance Replication snapshot is a workflow similar to that of the single cluster workflow, but with some caveats:

- Performance primary and secondary clusters can each load their own snapshots.
- Performance secondary clusters can perform snapshot operations on paths corresponding to local mounts, but can't perform snapshot operations on any shared paths.

These examples show how to recover a secret from a snapshot to a Performance Replication cluster secondary using automated snapshots and the Vault CLI or API.

<Tabs>

<Tab heading="CLI" group="cli">

When you use Vault Enterprise with automated snapshots, you don't need to first transfer the snapshot file. You can load a snapshot that Vault saved to cloud storage directly from its URL.

```shell-session
$ vault operator raft snapshot load \
    auto_config_name=zurich-secondary \
    url="https://bucket.example.com/vault-snapshots/secondary/zurich-backup.snap"
```

Vault returns information about the snapshot, including a `snapshot_id` value that you can use to perform further operations with the snapshot.

<CodeBlockConfig hideClipboard>

```plaintext
Key                                   Value
---                                   -----
auto_config_name                      zurich-secondary
cluster_id                            ce1862c4-c84d-4bb9-8579-079dcec3f892
expires_at                            2025-06-25T09:00:42.828919+00:00
snapshot_id                           37cc5b09-e6fb-4b2a-970b-dc8341af9cd0
status                                loading
```

</CodeBlockConfig>

Learn more in the [CLI documentation](/vault/docs/commands/operator/raft#snapshot-load).

After you start the snapshot load, you can check the snapshot loading status by reading the snapshot ID returned in the load output.

```shell-session
$ vault read \
    /sys/storage/raft/snapshot-load/37cc5b09-e6fb-4b2a-970b-dc8341af9cd0
```

Vault responds with snapshot details, including the status.

<CodeBlockConfig hideClipboard>

```plaintext
Key                                   Value
---                                   -----
auto_config_name                      zurich-secondary
cluster_id                            ce1862c4-c84d-4bb9-8579-079dcec3f892
expires_at                            2025-06-25T09:00:42.828919+00:00
snapshot_id                           37cc5b09-e6fb-4b2a-970b-dc8341af9cd0
status                                ready
```

</CodeBlockConfig>

When Vault loads the snapshot, the status value is `loading` until loading is complete, and the value changes to `ready` when you can use the snapshot for secret recovery.

If a problem occurs during loading, Vault sets the status to `error` and shares details about the problem.

<Note>

You can't recover secrets from a snapshot with an `error` status.

</Note>

#### Recover the secret

When the snapshot status is **ready**, you can recover the secret by specifying its path. 

Your Vault token must have the `recover` capability on a path to recover that path from a snapshot. For example to recover any secret on the path `development-lab`, your token needs an access control list policy like this example:

```hcl
path "development-lab/*" {
  capabilities = ["recover"]
}
```

In this example, recover the secret named `test-runner` from the key/value version 1 secrets engine enabled at the path `development-lab`.

```shell-session
$ vault read \
    -snapshot-id 37cc5b09-e6fb-4b2a-970b-dc8341af9cd0 \
    development-lab/test-runner
```

Vault reads the secret at the specified path from the snapshot, then sends that data to the secrets engine to recover the secret. The secrets engine uses this data potientally with its own information to create or update the data at the specified path in live cluster storage.

You can read the secret from its usual path in the secrets engine to test recovery.

```shell-session
$ vault kv get development-lab/test-runner
```

Vault responds with the secret data.

<CodeBlockConfig hideClipboard>

```plaintext
======= Data =======
Key           Value
---           -----
passphrase    guardant scanning dimmest bazaar macaroni tipoff
```

</CodeBlockConfig>

</Tab>

<Tab heading="API" group="api">

When you use Vault Enterprise with automated snapshots, you don't need to first transfer the snapshot file. You can load a snapshot that Vault saved to cloud storage directly from its URL. 

Create a JSON payload that defines the URL to the automated snapshot you need to load.

```shell-session
$ cat > payload.json << EOF
{
  "url": "https://bucket.example.com/vault-snapshots/secondary/zurich-backup.snap"
}
```

Load the snapshot that holds the secret you need to recover.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    https://127.0.0.1:8200/v1/sys/storage/raft/snapshot-auto/snapshot-load/zurich-secondary
```

Vault responds with snapshot details, including the status.

```json
{
  "data": {
    "auto_config_name": "zurich-secondary",
    "cluster_id": "ce1862c4-c84d-4bb9-8579-079dcec3f892",
    "expires_at": "2025-06-25T09:00:42.828919+00:00",
    "snapshot_id": "37cc5b09-E6FB-4b2a-970b-dc8341af9cd0",
    "url": "https://bucket.example.com/vault-snapshots/secondary/zurich-backup.snap",
    "status": "loading"
  }
}
```

After you start the snapshot load, you can check the snapshot loading status by reading the snapshot ID returned in the load output.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    http://127.0.0.1:8200/v1/sys/storage/raft/snapshot-load/37cc5b09-e6fb-4b2a-970b-dc8341af9cd0
```

Vault responds with snapshot details, including the status.

```json
{
  "data": {
    "auto_config_name": "zurich-secondary",
    "cluster_id": "ce1862c4-c84d-4bb9-8579-079dcec3f892",
    "expires_at": "2025-06-25T09:00:42.828919+00:00",
    "snapshot_id": "37cc5b09-e6fb-4b2a-970b-dc8341af9cd0",
    "url": "https://bucket.example.com/vault-snapshots/secondary/zurich-backup.snap",
    "status": "ready"
  }
}
```

When Vault loads the snapshot, the status value is `loading` until loading is complete, and the value changes to `ready` when you can use the snapshot for secret recovery.

If a problem occurs during loading, Vault sets the status to `error` and shares details about the problem.

<Note>

You can't recover secrets from a snapshot with an `error` status.

</Note>

#### Recover the secret

When the snapshot status is **ready**, you can recover the secret by specifying its path. 

Your Vault token must have the `recover` capability on a path to recover that path from a snapshot. For example to recover any secret on the path `development-lab`, your token needs an access control list policy like this example:

```hcl
path "development-lab/*" {
  capabilities = ["recover"]
}
```

In this example, recover the secret named `test-runner` from the key/value version 1 secrets engine enabled at the path `development-lab`.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    https://127.0.0.1:8200/v1/development-lab/test-runner?recover_snapshot_id=37cc5b09-E6FB-4b2a-970b-dc8341af9cd0
```

Vault reads the secret at the specified path from the snapshot, then sends that data to the secrets engine to recover the secret. The secrets engine uses this data potientally with its own information to create or update the data at the specified path in live cluster storage.

You can read the secret from its usual path in the secrets engine to test recovery.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request GET \
    https://127.0.0.1:8200/v1/development-lab/test-runner
```

Vault responds with the secret data.

```json
{
    "request_id": "59d2b213-71fb-b5c2-8022-f6d14dab8d0c",
    "lease_id": "",
    "renewable": false,
    "lease_duration": 2764800,
    "data": {
        "passphrase": "guardant scanning dimmest bazaar macaroni tipoff"
    },
    "wrap_info": null,
    "warnings": null,
    "auth": null,
    "mount_type": "kv"
}
```

</Tab>

</Tabs>
