---
layout: docs
page_title: Manage snapshots
description: >-
  Save and restore data from cluster snapshots.
---

# Manage snapshots

All Vault editions support data backup and restoration with manual snapshots of the cluster state. Vault Enterprise adds support for configurable automated snapshots to local and cloud storage.

When you save and securely retain Vault cluster snapshots, you help defend against data corruption or sabotage. You can further support data availability in the event of catastrophic failure by retaining cluster snapshots outside cluster storage or physical datacenters where clusters operate.

This guidance provides snapshot management details, and command examples for the Vault CLI and API. Refer to the [Resources](#resources) section of this document for more details about the API endpoints and CLI commands shown in the examples.

<Tip>

If you're saving snapshots in preparation for a Vault Enterprise upgrade, review the [Automate upgrades with Vault Enterprise](/vault/tutorials/raft/raft-upgrade-automation) guide to learn how Autopilot can automate your upgrades.

</Tip>

## Prerequisites

Ensure that you carry out or understand these items **before** you try to save or restore Vault snapshots.

- **Working Vault knowledge:**
   You need some working Vault knoweldge to follow the examples. You should be familiar with using Vault with the CLI, API, or UI.

- **Valid Vault cluster configuration:**
   Your Vault cluster must have valid cluster configuration as defined in the guidance in [Vault with integrated storage reference architecture](/vault/tutorials/day-one-raft/raft-reference-architecture).

- **Vault ready for use:**
   Your Vault cluster must be in an initialized state, with keyholders available
   to enter the unseal or recovery keys. You must also have access to tokens with required capabilities to access encrypted data in the storage.

## Save a cluster snapshot

All Vault editions offer support for manually saving cluster snapshots. These example steps show how to manually take a snapshot from a Vault cluster leader node with the CLI or API.

<Note> 

Keep in mind that the exact steps needed depend on your specific Vault architecture and storage type, and can differ from the examples shown here.

</Note>

Choose a tab, and learn how to manually save a snapshot for a single cluster, a disaster recovery (DR) replication cluster, or a performance replication cluster.

<Tabs>

<Tab heading="Single cluster" group="single">

### Save a single cluster snapshot

These examples show how to take a snapshot of a single cluster with the Vault CLI or API.

<Tabs>

<Tab heading="CLI" group="cli">

Use the Vault CLI to take a snapshot from the cluster members with a command like this example.

```shell-session
$ vault operator raft snapshot save backup.snap
```

This command writes a snapshot to the local file `backup.snap`.

Learn more in the [snapshot CLI documentation](/vault/docs/commands/operator/raft#snapshot).

</Tab>

<Tab heading="API" group="api">

Use cURL with the Vault API to take a snapshot from the cluster members with a command like this example.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request GET \
    https://127.0.0.1:8200/v1/sys/storage/raft/snapshot > backup.snap
```

This command writes a snapshot to the local file `backup.snap`.

Learn more in the [snapshot API documentation](/vault/api-docs/system/storage/raft#take-a-snapshot-of-the-raft-cluster).

</Tab>

</Tabs>

</Tab>

<Tab heading="DR Replication cluster" group="dr">

### Save a DR Replication cluster snapshot

These examples show how to take a snapshot of a cluster participating in DR Replication with the Vault CLI or API.

<Tabs>

<Tab heading="CLI" group="cli">

Take snapshots from the cluster members on the DR Primary cluster using a command like this example.

```shell-session
$ vault operator raft snapshot save primary.snap
```

This command writes a snapshot to the local file `primary.snap`.

Learn more in the [snapshot CLI documentation](/vault/docs/commands/operator/raft#snapshot).

</Tab>

<Tab heading="API" group="api">

Use cURL with the Vault API to take snapshots from the cluster members with a command like this example.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request GET \
    https://127.0.0.1:8200/v1/sys/storage/raft/snapshot > primary.snap
```

This command writes a snapshot to the local file `primary.snap`.

Learn more in the [snapshot API documentation](/vault/api-docs/system/storage/raft#take-a-snapshot-of-the-raft-cluster).

</Tab>

</Tabs>

</Tab>

<Tab heading="Performance Replication cluster" group="perf">

### Save a Performance Replication cluster snapshot

These examples show how to take a snapshot of a cluster participating in Performance Replication with the Vault CLI or API.

<Tabs>

<Tab heading="CLI" group="cli">

Take separate snapshots from the Vault Integrated Storage (Raft) cluster members
supporting both the Performance Primary cluster and Performance Secondary
cluster using commands like these examples.

First, take a snapshot on the primary cluster.

```shell-session
$ vault operator raft snapshot save primary.snap
```

This command writes a snapshot to the local file `primary.snap`.

Next, take a snapshot on the secondary cluster.

```shell-session
$ vault operator raft snapshot save secondary.snap
```

This command writes a snapshot to the local file `secondary.snap`.

Learn more in the [snapshot CLI documentation](/vault/docs/commands/operator/raft#snapshot).

</Tab>

<Tab heading="API" group="api">

Take separate snapshots from the Vault Integrated Storage (Raft) cluster members
supporting both the Performance Primary cluster and Performance Secondary
cluster using commands like these examples.

First, take a snapshot on the primary cluster.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request GET \
    https://127.0.0.1:8200/v1/sys/storage/raft/snapshot > primary.snap
```

This command writes a snapshot to the local file `primary.snap`.

Next, take a snapshot on the secondary cluster.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request GET \
    https://127.0.0.1:8200/v1/sys/storage/raft/snapshot > secondary.snap
```

This command writes a snapshot to the local file `secondary.snap`.

Learn more in the [snapshot API documentation](/vault/api-docs/system/storage/raft#take-a-snapshot-of-the-raft-cluster).

</Tab>

</Tabs>

</Tab>

</Tabs>

<Tip>

As a best practice, you should retain snapshot files in a secure place away from the Vault clusters and their infrastructure.

</Tip>

## Enable automated cluster snapshots

@include 'alerts/enterprise-only.mdx'

Vault Enterprise features configurable automated snapshots written to local or cloud storage on an interval. Follow these steps to enable automated snapshots.

<Tabs>

<Tab heading="Single cluster" group="single">

### Enable a single cluster automated snapshot

These examples show how to configure automated snapshots for a single cluster with the Vault CLI or API.

<Tabs>

<Tab heading="CLI" group="cli">

Enable automated snapshots with the following example commands, based on the
instructions in the [automated snapshots with integrated storage documentation](/vault/docs/enterprise/automated-integrated-storage-snapshots)
with options specified in the [API
documentation](/vault/api-docs/system/storage/raftautosnapshots#create-update-an-automated-snapshots-config).

```shell-session
$ vault write sys/storage/raft/snapshot-auto/config/[:name] [options]
```

**Example:**

The following command creates an automated snapshot configuration named,
`testsnap` with a user defined location and interval.

```shell-session
$ vault write sys/storage/raft/snapshot-auto/config/testsnap \
     storage_type=local \
     file_prefix=testsnappy \
     interval=120m \
     retain=7 \
     local_max_space=262144000 \
     path_prefix=/opt/vault/
```

This example specifies local storage with both a filename and path prefix, a 120 minute snapshot interval, and retainins up to 7 snapshots before deleting earlier snapshots. The configuration also requires that the snapshots with the given `file_prefix` value and in the specified `path_prefix` value consume no more than 250 megabytes (262144000 bytes) of storage. If snapshots reach this value, Vault cannot write a snapshot until enough space is available.

Learn more in the [API documentation](/vault/api-docs/system/storage/raftautosnapshots#create-update-an-automated-snapshots-config).

</Tab>

<Tab heading="API" group="api">

Create a JSON payload to configure automated snapshot settings.

```shell-session
$ cat > payload.json << EOF
{
    "storage_type": "local",
    "file_prefix": "testsnappy",
    "interval": "120m",
    "retain": "7",
    "local_max_space": "262144000",
    "path_prefix": "/opt/vault/"
}
EOF
```

This example specifies local storage with both a filename and path prefix, a 120 minute snapshot interval, and retainins up to 7 snapshots before deleting earlier snapshots. The configuration also requires that the snapshots with the given `file_prefix` value and in the specified `path_prefix` value consume no more than 250 megabytes (262144000 bytes) of storage. If snapshots reach this value, Vault cannot write a snapshot until enough space is available.

Use cURL with the Vault API and JSON payload to configure automated snapshots.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    https://127.0.0.1:8200/v1/sys/storage/raft/snapshot-auto/config/testsnap
```

Learn more in the [API documentation](/vault/api-docs/system/storage/raftautosnapshots#create-update-an-automated-snapshots-config).

</Tab>

</Tabs>

</Tab>

<Tab heading="DR Replication cluster" group="dr">

### Enable DR Replication cluster automated snapshots

These examples show how to configure automated snapshots for a cluster participating in DR Replication with the Vault CLI or API.

<Tabs>

<Tab heading="CLI" group="cli">

Enable automated snapshots with the following example commands, based on the
instructions in the [automated snapshots with integrated storage documentation](/vault/docs/enterprise/automated-integrated-storage-snapshots)
with options specified in the [API
documentation](/vault/api-docs/system/storage/raftautosnapshots#create-update-an-automated-snapshots-config).

```shell-session
$ vault write sys/storage/raft/snapshot-auto/config/[:name] [options]
```

#### Enable automated snapshots on primary cluster

The following command creates an automated snapshot configuration named,
`paris-primary` with a user defined location and interval.

This example specifies AWS S3 storage with appropriate AWS configuration options for the bucket name, the region, and required credentials. Snapshots are further protected with server side encryption.

```shell-session
$ vault write sys/storage/raft/snapshot-auto/config/paris-primary \
    storage_type="aws-s3" \
    file_prefix="paris" \
    interval="8h" \
    retain=30 \
    local_max_space=2621440000 \
    path_prefix="primary" \
    aws_s3_bucket="vault-snapshots" \
    aws_s3_region="eu-west-3" \
    aws_access_key_id="ASI...COFFEE" \
    aws_secret_access_key="wJalr...COFFEEKEY" \
    aws_session_token="IQoJb3JpZ2luX2IQ...COFFEE" \
    aws_s3_server_side_encryption=true
```

The configuration also specifies local storage with both a filename and path prefix, a 120 minute snapshot interval, and retainins up to 7 snapshots before deleting earlier snapshots. The configuration also requires that the snapshots with the given `file_prefix` value and in the specified `path_prefix` value consume no more than 250 megabytes (262144000 bytes) of storage. If snapshots reach this value, Vault cannot write a snapshot until enough space is available.

#### Enable automated snapshots on secondary cluster

The following command creates an automated snapshot configuration named,
`zurich-secondary` with a user defined location and interval.

This example specifies AWS S3 storage with appropriate AWS configuration options for the bucket name, the region, and required credentials. Snapshots are further protected with server side encryption.

```shell-session
$ vault write sys/storage/raft/snapshot-auto/config/zurich-secondary \
    storage_type="aws-s3" \
    file_prefix="zurich" \
    interval="8h" \
    retain=30 \
    local_max_space=2621440000 \
    path_prefix="secondary" \
    aws_s3_bucket="vault-snapshots" \
    aws_s3_region="eu-central-2" \
    aws_access_key_id="ASI...COFFEE" \
    aws_secret_access_key="wJalr...COFFEEKEY" \
    aws_session_token="IQoJb3JpZ2luX2IQ...COFFEE" \
    aws_s3_server_side_encryption=true
```

The configuration further defines local storage with both a filename and path prefix, a 12 hour snapshot interval, and retainins up to 14 snapshots before deleting earlier snapshots. The configuration also requires that the snapshots with the given `file_prefix` value and in the specified `path_prefix` value consume no more than 2.6 gigabytes (2621440000 bytes) of storage. If snapshots reach this value, Vault cannot write a snapshot until enough space is available.

Learn more in the [API documentation](/vault/api-docs/system/storage/raftautosnapshots#create-update-an-automated-snapshots-config).

</Tab>

<Tab heading="API" group="api">

#### Enable automated snapshots on primary cluster

Create a JSON payload to configure automated snapshot settings for the **primary** DR cluster.

This example specifies AWS S3 storage with appropriate AWS configuration options for the bucket name, the region, and required credentials. Snapshots are further protected with server side encryption.

```shell-session
$ cat > payload.json << EOF
{
    "storage_type": "aws-s3",
    "aws_s3_bucket": "vault-snapshots",
    "aws_s3_region": "eu-west-3",
    "aws_access_key_id": "ASIAIOSFODNN7ECOFFEE",
    "aws_secret_access_key ": "wJalrXUtnFEMI/K7MDENG/bPxRfiCYECOFFEEKEY",
    "aws_session_token": "IQoJb3JpZ2luX2IQoJb3JpZ2luX2IQoJb3JpZ2luX2IQoJb3JpZ2luX2IQoJb3JpZVERYLONGSTRINGECOFFEE",
    "aws_s3_server_side_encryption": true,
    "file_prefix": "paris",
    "interval": "8h",
    "retain": "30",
    "local_max_space": "2621440000",
    "path_prefix": "primary"
}
EOF
```

The configuration further defines both a filename and path prefix, an 8 hour snapshot interval, and retainins up to 30 snapshots before deleting earlier snapshots. Snapshots with the given `file_prefix` value and in the specified `path_prefix` value must not consume more than 2.6 gigabytes (2621440000 bytes) of storage. If snapshots reach this value, Vault cannot write a snapshot until enough space is available.

Use cURL with the Vault API to create an automated snapshot configuration named `paris-primary` for the DR primary cluster.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    https://127.0.0.1:8200/v1/sys/storage/raft/snapshot-auto/config/paris-primary
```

#### Enable automated snapshots on secondary cluster

Create a JSON payload to configure automated snapshot settings for the **secondary** DR cluster.

This example specifies AWS S3 storage with appropriate AWS configuration options for the bucket name, the region, and required credentials. Snapshots are further protected with server side encryption.

```shell-session
$ cat > payload.json << EOF
{
    "storage_type": "aws-s3",
    "aws_s3_bucket": "vault-snapshots",
    "aws_s3_region": "eu-central-2",
    "aws_access_key_id": "ASIAIOSFODNN7ECOFFEE",
    "aws_secret_access_key ": "wJalrXUtnFEMI/K7MDENG/bPxRfiCYECOFFEEKEY",
    "aws_session_token": "IQoJb3JpZ2luX2IQoJb3JpZ2luX2IQoJb3JpZ2luX2IQoJb3JpZ2luX2IQoJb3JpZVERYLONGSTRINGECOFFEE",
    "aws_s3_server_side_encryption": true,
    "file_prefix": "zurich",
    "interval": "8h",
    "retain": "30",
    "local_max_space": "2621440000",
    "path_prefix": "secondary"
}
EOF
```

The configuration further defines both a filename and path prefix, an 8 hour snapshot interval, and retainins up to 30 snapshots before deleting earlier snapshots. Snapshots with the given `file_prefix` value and in the specified `path_prefix` value must not consume more than 2.6 gigabytes (2621440000 bytes) of storage. If snapshots reach this value, Vault cannot write a snapshot until enough space is available.

Use cURL with the Vault API to create an automated snapshot configuration named `zurich-secondary` for the DR secondary cluster.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    https://127.0.0.1:8200/v1/sys/storage/raft/snapshot-auto/config/zurich-seconary
```

Learn more in the [API documentation](/vault/api-docs/system/storage/raftautosnapshots).

</Tab>

</Tabs>

</Tab>

<Tab heading="Performance Replication cluster" group="perf">

### Enable Performance Replication cluster automated snapshots

These examples show how to configure automated snapshots for a cluster participating in performance replication with the Vault CLI or API.

<Tabs>

<Tab heading="CLI" group="cli">

Enable automated snapshots with the following example commands, based on the
instructions in the [automated snapshots with integrated storage documentation](/vault/docs/enterprise/automated-integrated-storage-snapshots)
with options specified in the [API
documentation](/vault/api-docs/system/storage/raftautosnapshots#create-update-an-automated-snapshots-config).

```shell-session
$ vault write sys/storage/raft/snapshot-auto/config/[:name] [options]
```

#### Enable automated snapshots on primary cluster

The following command creates an automated snapshot configuration named,
`paris-primary` with a user defined location and interval.

This example specifies AWS S3 storage with appropriate AWS configuration options for the bucket name, the region, and required credentials. Snapshots are further protected with server side encryption.

```shell-session
$ vault write sys/storage/raft/snapshot-auto/config/paris-primary \
    storage_type="aws-s3" \
    file_prefix="paris" \
    interval="8h" \
    retain=30 \
    local_max_space=2621440000 \
    path_prefix="primary" \
    aws_s3_bucket="vault-snapshots" \
    aws_s3_region="eu-west-3" \
    aws_access_key_id="ASI...COFFEE" \
    aws_secret_access_key="wJalr...COFFEEKEY" \
    aws_session_token="IQoJb3JpZ2luX2IQ...COFFEE" \
    aws_s3_server_side_encryption=true
```

The configuration also specifies local storage with both a filename and path prefix, a 120 minute snapshot interval, and retainins up to 7 snapshots before deleting earlier snapshots. The configuration also requires that the snapshots with the given `file_prefix` value and in the specified `path_prefix` value consume no more than 250 megabytes (262144000 bytes) of storage. If snapshots reach this value, Vault cannot write a snapshot until enough space is available.

#### Enable automated snapshots on secondary cluster

The following command creates an automated snapshot configuration named,
`zurich-secondary` with a user defined location and interval.

This example specifies AWS S3 storage with appropriate AWS configuration options for the bucket name, the region, and required credentials. Snapshots are further protected with server side encryption.

```shell-session
$ vault write sys/storage/raft/snapshot-auto/config/zurich-secondary \
    storage_type="aws-s3" \
    file_prefix="zurich" \
    interval="8h" \
    retain=30 \
    local_max_space=2621440000 \
    path_prefix="secondary" \
    aws_s3_bucket="vault-snapshots" \
    aws_s3_region="eu-central-2" \
    aws_access_key_id="ASI...COFFEE" \
    aws_secret_access_key="wJalr...COFFEEKEY" \
    aws_session_token="IQoJb3JpZ2luX2IQ...COFFEE" \
    aws_s3_server_side_encryption=true
```

The configuration further defines local storage with both a filename and path prefix, a 12 hour snapshot interval, and retainins up to 14 snapshots before deleting earlier snapshots. The configuration also requires that the snapshots with the given `file_prefix` value and in the specified `path_prefix` value consume no more than 2.6 gigabytes (2621440000 bytes) of storage. If snapshots reach this value, Vault cannot write a snapshot until enough space is available.

Learn more in the [API documentation](/vault/api-docs/system/storage/raftautosnapshots#create-update-an-automated-snapshots-config).

</Tab>

<Tab heading="API" group="api">

#### Enable automated snapshots on primary cluster

Create a JSON payload to configure automated snapshot settings for the **primary** DR cluster.

This example specifies AWS S3 storage with appropriate AWS configuration options for the bucket name, the region, and required credentials. Snapshots are further protected with server side encryption.

```shell-session
$ cat > payload.json << EOF
{
    "storage_type": "aws-s3",
    "aws_s3_bucket": "vault-snapshots",
    "aws_s3_region": "eu-west-3",
    "aws_access_key_id": "ASIAIOSFODNN7ECOFFEE",
    "aws_secret_access_key ": "wJalrXUtnFEMI/K7MDENG/bPxRfiCYECOFFEEKEY",
    "aws_session_token": "IQoJb3JpZ2luX2IQoJb3JpZ2luX2IQoJb3JpZ2luX2IQoJb3JpZ2luX2IQoJb3JpZVERYLONGSTRINGECOFFEE",
    "aws_s3_server_side_encryption": true,
    "file_prefix": "paris",
    "interval": "8h",
    "retain": "30",
    "local_max_space": "2621440000",
    "path_prefix": "primary"
}
EOF
```

The configuration further defines both a filename and path prefix, an 8 hour snapshot interval, and retainins up to 30 snapshots before deleting earlier snapshots. Snapshots with the given `file_prefix` value and in the specified `path_prefix` value must not consume more than 2.6 gigabytes (2621440000 bytes) of storage. If snapshots reach this value, Vault cannot write a snapshot until enough space is available.

Use cURL with the Vault API to create an automated snapshot configuration named `paris-primary` for the DR primary cluster.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    https://127.0.0.1:8200/v1/sys/storage/raft/snapshot-auto/config/paris-primary
```

#### Enable automated snapshots on secondary cluster

Create a JSON payload to configure automated snapshot settings for the **secondary** DR cluster.

This example specifies AWS S3 storage with appropriate AWS configuration options for the bucket name, the region, and required credentials. Snapshots are further protected with server side encryption.

```shell-session
$ cat > payload.json << EOF
{
    "storage_type": "aws-s3",
    "aws_s3_bucket": "vault-snapshots",
    "aws_s3_region": "eu-central-2",
    "aws_access_key_id": "ASIAIOSFODNN7ECOFFEE",
    "aws_secret_access_key ": "wJalrXUtnFEMI/K7MDENG/bPxRfiCYECOFFEEKEY",
    "aws_session_token": "IQoJb3JpZ2luX2IQoJb3JpZ2luX2IQoJb3JpZ2luX2IQoJb3JpZ2luX2IQoJb3JpZVERYLONGSTRINGECOFFEE",
    "aws_s3_server_side_encryption": true,
    "file_prefix": "zurich",
    "interval": "8h",
    "retain": "30",
    "local_max_space": "2621440000",
    "path_prefix": "secondary"
}
EOF
```

The configuration further defines both a filename and path prefix, an 8 hour snapshot interval, and retainins up to 30 snapshots before deleting earlier snapshots. Snapshots with the given `file_prefix` value and in the specified `path_prefix` value must not consume more than 2.6 gigabytes (2621440000 bytes) of storage. If snapshots reach this value, Vault cannot write a snapshot until enough space is available.

Use cURL with the Vault API to create an automated snapshot configuration named `zurich-secondary` for the DR secondary cluster.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    https://127.0.0.1:8200/v1/sys/storage/raft/snapshot-auto/config/zurich-seconary
```

Learn more in the [API documentation](/vault/api-docs/system/storage/raftautosnapshots).

</Tab>

</Tabs>

</Tab>

</Tabs>

<Tip title="Tutorial">

Refer to the [configure Vault cluster with Integrated Storage](/vault/tutorials/raft/raft-storage#automated-snapshots) tutorial to learn more.

</Tip>

## Restore a cluster snapshot

These examples show how to restore a cluster snapshot with the Vault CLI or API.

<Tabs>

<Tab heading="Single cluster" group="single">

### Restore a single cluster snapshot

Use these examples to learn how to restore a snapshot to a single Vault cluster.

<Tabs>

<Tab heading="CLI" group="cli">

1. Bring your Vault cluster back online following the circumstances that
required you to restore from backup. You must reinitialize your Vault
cluster with new storage, and authenticate with the new initial root token generated during this re-initialization. Note that this situation is temporary- you still need the original cluster unseal keys to unseal Vault after restoring the snapshot.

1. Copy your Vault snapshot file to a Vault cluster member and run the
example command, replacing the example filename with that of your snapshot file. Note that you must use the `-force` flag in this command since the Auto-unseal or Shamir keys will not be consistent with the snapshot data as you are restoring a snapshot from a different cluster.

   ```shell-session
   $ vault operator raft snapshot restore -force backup.snap
   ```

   Learn more in the [CLI documentation](/vault/docs/commands/operator/raft#snapshot-restore).

1. After restoring the snapshot, you must unseal your Vault
cluster again using a command like this example. Typically each person with a key share would execute the unseal command and pass in their key share until reaching the number of key shares required by the quroum defined in your original cluster configuration.

   ```shell-session
   $ vault operator unseal [unseal_key]
   ```

   Learn more in the [CLI documentation](/vault/docs/commands/operator/unseal).

</Tab>

<Tab heading="API" group="api">

1. Bring your Vault cluster back online following the circumstances that
required you to restore from backup. You must reinitialize your Vault
cluster with new storage, and authenticate with the new initial root token generated during this re-initialization. Note that this situation is temporary- you still need the original cluster unseal keys to unseal Vault after restoring the snapshot.

1. Copy your Vault snapshot file to a Vault cluster member and run the
example command, replacing the example filename with that of your snapshot file. Note that you must use the `snapshot-force` API endpoint in this command since the Auto-unseal or Shamir keys will not be consistent with the snapshot data as you are restoring a snapshot from a different cluster.

   ```shell-session
   $ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data-binary @backup.snap \
    https://127.0.0.1:8200/v1/sys/storage/raft/snapshot-force
   ```

   Learn more in the [API documentation](/vault/api-docs/system/storage/raft#force-restore-raft-using-a-snapshot).

1. After restoring the snapshot, you must unseal your Vault
cluster again using a command like this example. Typically each person with a key share would execute the unseal command and pass in their key share until reaching the number of key shares required by the quroum defined in your original cluster configuration.

   Create a key share payload that holds one of the key shares.

   ```shell-session
   $ cat > payload.json << EOF
   {
   "key": "abcd1234..."
   }
   EOF
   ```

   Use cURL with the Vault API to unseal Vault.
   
   ```shell-session
   $ curl \
    --request POST \
    --data @payload.json \
    https://127.0.0.1:8200/v1/sys/unseal
   ```

   Learn more in the [API documentation](/vault/api-docs/system/unseal).

</Tab>

</Tabs>

</Tab>

<Tab heading="DR Replication cluster" group="dr">

### Restore a disaster recovery replication cluster snapshot

Use these examples to learn how to restore a snapshot to a DR Replication Vault cluster.

<Tabs>

<Tab heading="CLI" group="cli">

1. Bring your Vault cluster back online following the circumstances that
required you to restore from backup. You must reinitialise your Vault
cluster with new storage, and authenticate with the new initial root token generated during this re-initialisation. Note that this situation is temporary- you still need the original cluster unseal keys to unseal Vault after restoring the snapshot.

1. Copy your Vault snapshot files for the Primary and DR replica clusters onto restored members of the respective clusters and run the following example command, replacing the example filename with that of your snapshot file. Note that you must use the `-force` flag in this command since the Auto-unseal or Shamir keys will not be consistent with the snapshot data as you are restoring a snapshot from a different cluster.

   ```shell-session
   $ vault operator raft snapshot restore -force backup.snap
   ```

   Learn more in the [CLI documentation](/vault/docs/commands/operator/raft#snapshot-restore).

1. After restoring the snapshot, you must unseal your Vault
cluster again using a command like this example. Typically each person with a key share would execute the unseal command and pass in their key share until reaching the number of key shares required by the quroum defined in your original cluster configuration.

   ```shell-session
   $ vault operator unseal [unseal_key]
   ```

   Learn more in the [CLI documentation](/vault/docs/commands/operator/unseal).

</Tab>

<Tab heading="API" group="api">

1. Bring your Vault cluster back online following the circumstances that
required you to restore from backup. You must reinitialise your Vault
cluster with new storage, and authenticate with the new initial root token generated during this re-initialisation. Note that this situation is temporary- you still need the original cluster unseal keys to unseal Vault after restoring the snapshot.

1. Copy your Vault snapshot file to a Vault cluster member and run the
example command, replacing the example filename with that of your snapshot file. Note that you must use the `snapshot-force` API endpoint in this command since the Auto-unseal or Shamir keys will not be consistent with the snapshot data as you are restoring a snapshot from a different cluster.

   ```shell-session
   $ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data-binary @backup.snap \
    https://127.0.0.1:8200/v1/sys/storage/raft/snapshot-force
   ```

1. After restoring the snapshot, you must unseal your Vault
cluster again using a command like this example. Typically each person with a key share would execute the unseal command and pass in their key share until reaching the number of key shares required by the quroum defined in your original cluster configuration.

   Create a key share payload that holds one of the key shares.

   ```shell-session
   $ cat > payload.json << EOF
   {
   "key": "abcd1234..."
   }
   EOF
   ```

   Use cURL with the Vault API to unseal Vault.
   
   ```shell-session
   $ curl \
    --request POST \
    --data @payload.json \
    https://127.0.0.1:8200/v1/sys/unseal
   ```

   Learn more in the [API documentation](/vault/api-docs/system/unseal).

</Tab>

</Tabs>

</Tab>

<Tab heading="Performance Replication cluster" group="perf">

### Restore a Performance Replication cluster snapshot

Use these examples to learn how to restore a snapshot to a Performance Replication cluster.

<Tabs>

<Tab heading="CLI" group="cli">

1. Bring your Vault cluster back online following the circumstances that
required you to restore from backup. You must reinitialise your Vault
cluster with new storage, and authenticate with the new initial root token generated during this re-initialisation. Note that this situation is temporary- you still need the original cluster unseal keys to unseal Vault after restoring the snapshot.

1. Copy your Vault Raft Snapshots for the Primary and Secondary Performance
Replica clusters onto restored members of the respective clusters and run the following example command, replacing the example filename with that of your snapshot file. Note that you must use the `-force` flag in this command since the Auto-unseal or Shamir keys will not be consistent with the snapshot data as you are restoring a snapshot from a different cluster.

   ```shell-session
   $ vault operator raft snapshot restore -force backup.snap
   ```

1. After restoring the snapshot, you must unseal your Vault
cluster again using a command like this example. Typically each person with a key share would execute the unseal command and pass in their key share until reaching the number of key shares required by the quroum defined in your original cluster configuration.

   ```shell-session
   $ vault operator unseal [unseal_key]
   ```

</Tab>

<Tab heading="API" group="api">

1. Bring your Vault cluster back online following the circumstances that
required you to restore from backup. You must reinitialise your Vault
cluster with new storage, and authenticate with the new initial root token generated during this re-initialisation. Note that this situation is temporary- you still need the original cluster unseal keys to unseal Vault after restoring the snapshot.

1. Copy your Vault Raft Snapshots for the Primary and Secondary Performance
Replica clusters onto restored members of the respective clusters and run the following example command, replacing the example filename with that of your snapshot file. Note that you must use the `-force` flag in this command since the Auto-unseal or Shamir keys will not be consistent with the snapshot data as you are restoring a snapshot from a different cluster.

1. Copy your Vault snapshot file to a Vault cluster member and run the
example command, replacing the example filename with that of your snapshot file. Note that you must use the `snapshot-force` API endpoint in this command since the Auto-unseal or Shamir keys will not be consistent with the snapshot data as you are restoring a snapshot from a different cluster.

   ```shell-session
   $ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data-binary @backup.snap \
    https://127.0.0.1:8200/v1/sys/storage/raft/snapshot-force
   ```

1. After restoring the snapshot, you must unseal your Vault
cluster again using a command like this example. Typically each person with a key share would execute the unseal command and pass in their key share until reaching the number of key shares required by the quroum defined in your original cluster configuration.

   Create a key share payload that holds one of the key shares.

   ```shell-session
   $ cat > payload.json << EOF
   {
   "key": "abcd1234..."
   }
   EOF
   ```

   Use cURL with the Vault API to unseal Vault.
   
   ```shell-session
   $ curl \
    --request POST \
    --data @payload.json \
    https://127.0.0.1:8200/v1/sys/unseal
   ```

   Learn more in the [API documentation](/vault/api-docs/system/unseal).

</Tab>

</Tabs>

</Tab>

</Tabs>

## Recover a secret

@include 'alerts/enterprise-only.mdx'

Vault Enterprise features a flexible, robust, and delegatable recovery mechanism for restoring deleted or mistakenly changed secrets that prioritizes Vault cluster availability. 

Secret Recovery enables you to delegate recovery of specific individual secrets from a cluster snapshot without restoring the complete cluster state or negatively impacting the Vault cluster.

You can use Secret Recovery to recover secrets from the following secrets engines:

- [Cubbyhole](/vault/docs/secrets/cubbyhole)
- [KV secrets engine - version 1](/vault/docs/secrets/kv/kv-v1)

@include 'recover/deletedmounts.mdx'

<Tabs>
<Tab heading="Single cluster" group="single">

### Recover a single cluster secret

Use these examples to learn how to recover a secret from a snapshot to a single cluster.

<Tabs>

<Tab heading="CLI" group="cli">

Load the snapshot that holds the secret you need to recover. Note that you load snapshots differently based on whether you use automated snapshots.

@include 'recover/loadedsnapshots.mdx'

Before you can load a manual snapshot, you must transfer the snapshot file from secure storage to a system with access to the cluster.

#### Load a manual snapshot without automated snapshots

Load a manually-saved snapshot.

```shell-session
$ vault operator raft snapshot load backup.snap
```

Vault returns information about the snapshot, including a `snapshot_id` value that you can use to perform further operations with the snapshot and the snapshot status.

<CodeBlockConfig hideClipboard>

```plaintext
Key                                   Value
---                                   -----
cluster_id                            990195d2-9f10-4e5c-84c5-543b4c250dc6
expires_at                            2025-06-14T09:00:00.675319+05:00
snapshot_id                           e57cd0cf-c3fa-4e5e-96ea-4a68fa8f3269
status                                loading
```

</CodeBlockConfig>

Learn more in the [CLI documentation](/vault/docs/commands/operator/raft#snapshot-load).

#### Load an automated snapshot 

When you use Vault Enterprise with automated snapshots, you don't need to first transfer the snapshot file. You can load a snapshot that Vault saved to cloud storage directly from its URL.

```shell-session
$ vault operator raft snapshot load \
    auto_config_name=paris-primary \
    url="https://bucket.example.com/vault-snapshots/primary/paris-backup.snap"
```

Vault returns information about the snapshot, including a `snapshot_id` value that you can use to perform further operations with the snapshot.
<CodeBlockConfig hideClipboard>

```plaintext
Key                                   Value
---                                   -----
auto_config_name                      paris-primary
cluster_id                            7430fa38-8fb6-4b35-b2a7-27ed4c831a44
expires_at                            2025-07-16T03:24:42.867531+05:00
snapshot_id                           9465df92-8236-4af9-8cc8-b7460d882e41
status                                loading
```

</CodeBlockConfig>

Learn more in the [CLI documentation](/vault/docs/commands/operator/raft#snapshot-load).

After you start the snapshot load, you can check the snapshot loading status by reading the snapshot ID returned in the load output.

```shell-session
$ vault read \
    /sys/storage/raft/snapshot-load/9465df92-8236-4af9-8cc8-b7460d882e41
```

Vault responds with snapshot details, including the status.

<CodeBlockConfig hideClipboard>

```plaintext
Key                                   Value
---                                   -----
auto_config_name                      paris-primary
cluster_id                            7430fa38-8fb6-4b35-b2a7-27ed4c831a44
expires_at                            2025-07-16T03:24:42.867531+05:00
snapshot_id                           9465df92-8236-4af9-8cc8-b7460d882e41
status                                ready
```

</CodeBlockConfig>

When Vault loads the snapshot, the status value is `loading` until loading is complete, and the value changes to `ready` when you can use the snapshot for secret recovery.

If a problem occurs during loading, Vault sets the status to `error` and shares details about the problem.

<Note>

You can't recover secrets from a snapshot with an `error` status.

</Note>

#### Recover the secret

When the snapshot status is **ready**, you can recover the secret by specifying its path. 

Your Vault token must have the `recover` capability on a path to recover that path from a snapshot. For example to recover any secret on the path `telemetry-systems`, your token needs an access control list policy like this example:

```hcl
path "telemetry-systems/*" {
  capabilities = ["recover"]
}
```

In this example, recover the secret named `api-key` from the key/value version 1 secrets engine enabled at the path `telemetry-systems`.

```shell-session
$ vault read \
    -snapshot-id 9465df92-8236-4af9-8cc8-b7460d882e41s \
    telemetry-systems/api-key
```

Vault reads the secret at the specified path from the snapshot, then sends that data to the secrets engine to recover the secret. The secrets engine uses this data potientally with its own information to create or update the data at the specified path in live cluster storage.

You can read the secret from its usual path in the secrets engine to test recovery.

```shell-session
$ vault kv get telemetry-systems/api-key
```

Vault responds with the secret data.

<CodeBlockConfig hideClipboard>

```plaintext
=== Data ===
Key    Value
---    -----
key    9C016BB3-F574-4A24-B8A7-8CE1F1CE2128
```

</CodeBlockConfig>

</Tab>

<Tab heading="API" group="api">

Load a **manual snapshot** without automated snapshots.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data-binary @backup.snap \
    https://127.0.0.1:8200/v1/sys/storage/raft/snapshot-load
```

Vault responds with details about the snapshot:

<CodeBlockConfig hideClipboard>

```json
{
  "data": {
    "cluster_id": "990195d2-9f10-4e5c-84c5-543b4c250dc6",
    "expires_at": "2025-06-14T09:00:00.675319+05:00",
    "snapshot_id": "e57cd0cf-c3fa-4e5e-96ea-4a68fa8f3269",
    "status": "loading"
  }
}
```

</CodeBlockConfig>

Load an **automated snapshot**.

When you use Vault Enterprise with automated snapshots, you don't need to first transfer the snapshot file. You can load a snapshot that Vault saved to cloud storage directly from its URL. 

Create a JSON payload that defines the URL to the automated snapshot you need to load.

```shell-session
$ cat > payload.json << EOF
{
  "url": "https://bucket.example.com/vault-snapshots/primary/paris-backup.snap"
}
```

Load the snapshot that holds the secret you need to recover.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    https://127.0.0.1:8200/v1/sys/storage/raft/snapshot-auto/snapshot-load/paris-primary
```

Vault responds with snapshot details, including the status.

```json
{
  "data": {
    "auto_config_name": "paris-primary",
    "cluster_id": "7430fa38-8fb6-4b35-b2a7-27ed4c831a44",
    "expires_at": "2025-07-16T03:24:42.867531+05:00",
    "snapshot_id": "9465df92-8236-4af9-8cc8-b7460d882e41",
    "url": "https://bucket.example.com/vault-snapshots/primary/paris-backup.snap",
    "status": "loading"
  }
}
```

After you start the snapshot load, you can check the snapshot loading status by reading the snapshot ID returned in the load output.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    http://127.0.0.1:8200/v1/sys/storage/raft/snapshot-load/9465df92-8236-4af9-8cc8-b7460d882e41
```

Vault responds with snapshot details, including the status.

```json
{
  "data": {
    "auto_config_name": "paris-primary",
    "cluster_id": "7430fa38-8fb6-4b35-b2a7-27ed4c831a44",
    "expires_at": "2025-07-16T03:24:42.867531+05:00",
    "snapshot_id": "9465df92-8236-4af9-8cc8-b7460d882e41",
    "url": "https://bucket.example.com/vault-snapshots/primary/paris-backup.snap",
    "status": "ready"
  }
}
```

When Vault loads the snapshot, the status value is `loading` until loading is complete, and the value changes to `ready` when you can use the snapshot for secret recovery.

If a problem occurs during loading, Vault sets the status to `error` and shares details about the problem.

<Note>

You can't recover secrets from a snapshot with an `error` status.

</Note>

#### Recover the secret

When the snapshot status is **ready**, you can recover the secret by specifying its path. 

Your Vault token must have the `recover` capability on a path to recover that path from a snapshot. For example to recover any secret on the path `telemetry-systems`, your token needs an access control list policy like this example:

```hcl
path "telemetry-systems/*" {
  capabilities = ["recover"]
}
```

In this example, recover the secret named `api-key` from the key/value version 1 secrets engine enabled at the path `telemetry-systems`.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    https://127.0.0.1:8200/v1/telemetry-systems/api-key?recover_snapshot_id=9465df92-8236-4af9-8cc8-b7460d882e41
```

Vault reads the secret at the specified path from the snapshot, then sends that data to the secrets engine to recover the secret. The secrets engine uses this data potientally with its own information to create or update the data at the specified path in live cluster storage.

You can read the secret from its usual path in the secrets engine to test recovery.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request GET \
    https://127.0.0.1:8200/v1/telemetry-systems/api-key
```

Vault responds with the secret data.

```json
{
    "request_id": "689b2708-fe46-4ee6-0f1a-830f4d3acce0",
    "lease_id": "",
    "renewable": false,
    "lease_duration": 2764800,
    "data": {
        "key": "9C016BB3-F574-4A24-B8A7-8CE1F1CE2128"
    },
    "wrap_info": null,
    "warnings": null,
    "auth": null,
    "mount_type": "kv"
}
```

</Tab>

</Tabs>

</Tab>

<Tab heading="DR Replication cluster" group="dr">

### Recover a DR Replication cluster secret

Loading and recovering secrets from a DR replication snapshot is a workflow similar to that of the single cluster workflow, but with some caveats:

- You must load the snapshot on the primary cluster. 
- You cannot load snapshots on secondary clusters.

These examples show how to recover a secret from a snapshot to a DR Replication cluster using automated snapshots and the Vault CLI or API.

<Tabs>

<Tab heading="CLI" group="cli">

Load the automated snapshot that holds the secret you need to recover on the **primary** cluster.

```shell-session
$ vault operator raft snapshot load \
    auto_config_name=paris-primary \
    url="https://bucket.example.com/vault-snapshots/primary/paris-backup.snap"
```

Vault returns information about the snapshot, including a `snapshot_id` value that you can use to perform further operations with the snapshot.

```plaintext
Key                                   Value
---                                   -----
auto_config_name                      paris-primary
cluster_id                            7430fa38-8fb6-4b35-b2a7-27ed4c831a44
expires_at                            2025-07-16T03:24:42.867531+05:00
snapshot_id                           9465df92-8236-4af9-8cc8-b7460d882e41
status                                loading
```

Learn more in the [CLI documentation](/vault/docs/commands/operator/raft#snapshot-load).

After you start the snapshot load, you can check the snapshot loading status by reading the snapshot ID returned in the load output.

```shell-session
$ vault read \
    /sys/storage/raft/snapshot-load/9465df92-8236-4af9-8cc8-b7460d882e41
```

Vault responds with snapshot details, including the status.

```plaintext
Key                                   Value
---                                   -----
auto_config_name                      paris-primary
cluster_id                            7430fa38-8fb6-4b35-b2a7-27ed4c831a44
expires_at                            2025-07-16T03:24:42.867531+05:00
snapshot_id                           9465df92-8236-4af9-8cc8-b7460d882e41
status                                ready
```

When Vault loads the snapshot, the status value is `loading` until loading is complete, and the value changes to `ready` when you can use the snapshot for secret recovery.

If a problem occurs during loading, Vault sets the status to `error` and shares details about the problem.

<Note>

You can't recover secrets from a snapshot with an `error` status.

</Note>

#### Recover the secret

When the snapshot status is **ready**, you can recover the secret by specifying its path. 

Your Vault token must have the `recover` capability on a path to recover that path from a snapshot. For example to recover any secret on the path `telemetry-systems`, your token needs an access control list policy like this example:

```hcl
path "telemetry-systems/*" {
  capabilities = ["recover"]
}
```

In this example, recover the secret named `api-key` from the key/value version 1 secrets engine enabled at the path `telemetry-systems`.

```shell-session
$ vault read \
    -snapshot-id 9465df92-8236-4af9-8cc8-b7460d882e41s \
    telemetry-systems/api-key
```

Vault reads the secret at the specified path from the snapshot, then sends that data to the secrets engine to recover the secret. The secrets engine uses this data potientally with its own information to create or update the data at the specified path in live cluster storage.

You can read the secret from its usual path in the secrets engine to test recovery.

```shell-session
$ vault kv get telemetry-systems/api-key
```

Vault responds with the secret data.

```plaintext
=== Data ===
Key    Value
---    -----
key    9C016BB3-F574-4A24-B8A7-8CE1F1CE2128
```

</Tab>

<Tab heading="API" group="api">

When you use Vault Enterprise with automated snapshots, you don't need to first transfer the snapshot file. You can load a snapshot that Vault saved to cloud storage directly from its URL. 

Create a JSON payload that defines the URL to the automated snapshot you need to load.

```shell-session
$ cat > payload.json << EOF
{
  "url": "https://bucket.example.com/vault-snapshots/primary/paris-backup.snap"
}
```

Load the snapshot that holds the secret you need to recover.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    https://127.0.0.1:8200/v1/sys/storage/raft/snapshot-auto/snapshot-load/paris-primary
```

Vault responds with snapshot details, including the status.

```json
{
  "data": {
    "auto_config_name": "paris-primary",
    "cluster_id": "7430fa38-8fb6-4b35-b2a7-27ed4c831a44",
    "expires_at": "2025-07-16T03:24:42.867531+05:00",
    "snapshot_id": "9465df92-8236-4af9-8cc8-b7460d882e41",
    "url": "https://bucket.example.com/vault-snapshots/primary/paris-backup.snap",
    "status": "loading"
  }
}
```

After you start the snapshot load, you can check the snapshot loading status by reading the snapshot ID returned in the load output.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    http://127.0.0.1:8200/v1/sys/storage/raft/snapshot-load/9465df92-8236-4af9-8cc8-b7460d882e41
```

Vault responds with snapshot details, including the status.

<CodeBlockConfig hideClipboard>

```json
{
  "data": {
    "auto_config_name": "paris-primary",
    "cluster_id": "7430fa38-8fb6-4b35-b2a7-27ed4c831a44",
    "expires_at": "2025-07-16T03:24:42.867531+05:00",
    "snapshot_id": "9465df92-8236-4af9-8cc8-b7460d882e41",
    "url": "https://bucket.example.com/vault-snapshots/primary/paris-backup.snap",
    "status": "ready"
  }
}
```

</CodeBlockConfig>

When Vault loads the snapshot, the status value is `loading` until loading is complete, and the value changes to `ready` when you can use the snapshot for secret recovery.

If a problem occurs during loading, Vault sets the status to `error` and shares details about the problem.

<Note>

You can't recover secrets from a snapshot with an `error` status.

</Note>

#### Recover the secret

When the snapshot status is **ready**, you can recover the secret by specifying its path. 

Your Vault token must have the `recover` capability on a path to recover that path from a snapshot. For example to recover any secret on the path `telemetry-systems`, your token needs an access control list policy like this example:

```hcl
path "telemetry-systems/*" {
  capabilities = ["recover"]
}
```

In this example, recover the secret named `api-key` from the key/value version 1 secrets engine enabled at the path `telemetry-systems`.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    https://127.0.0.1:8200/v1/telemetry-systems/api-key?recover_snapshot_id=9465df92-8236-4af9-8cc8-b7460d882e41
```

Vault reads the secret at the specified path from the snapshot, then sends that data to the secrets engine to recover the secret. The secrets engine uses this data potientally with its own information to create or update the data at the specified path in live cluster storage.

You can read the secret from its usual path in the secrets engine to test recovery.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request GET \
    https://127.0.0.1:8200/v1/telemetry-systems/api-key
```

Vault responds with the secret data.

```json
{
    "request_id": "689b2708-fe46-4ee6-0f1a-830f4d3acce0",
    "lease_id": "",
    "renewable": false,
    "lease_duration": 2764800,
    "data": {
        "key": "9C016BB3-F574-4A24-B8A7-8CE1F1CE2128"
    },
    "wrap_info": null,
    "warnings": null,
    "auth": null,
    "mount_type": "kv"
}
```

</Tab>

</Tabs>

</Tab>

<Tab heading="Performance Replication cluster" group="perf">

### Recover a Performance Replication cluster secret

Loading and recovering secrets from a Performance Replication snapshot is a workflow similar to that of the single cluster workflow, but with some caveats:

- Performance primary and secondary clusters can each load their own snapshots.
- Performance secondary clusters can perform snapshot operations on paths corresponding to local mounts, but can't perform snapshot operations on any shared paths.

These examples show how to recover a secret from a snapshot to a Performance Replication cluster secondary using automated snapshots and the Vault CLI or API.

<Tabs>

<Tab heading="CLI" group="cli">

When you use Vault Enterprise with automated snapshots, you don't need to first transfer the snapshot file. You can load a snapshot that Vault saved to cloud storage directly from its URL.

```shell-session
$ vault operator raft snapshot load \
    auto_config_name=zurich-secondary \
    url="https://bucket.example.com/vault-snapshots/secondary/zurich-backup.snap"
```

Vault returns information about the snapshot, including a `snapshot_id` value that you can use to perform further operations with the snapshot.

```plaintext
Key                                   Value
---                                   -----
auto_config_name                      zurich-secondary
cluster_id                            ce1862c4-c84d-4bb9-8579-079dcec3f892
expires_at                            2025-06-25T09:00:42.828919+00:00
snapshot_id                           37cc5b09-e6fb-4b2a-970b-dc8341af9cd0
status                                loading
```

Learn more in the [CLI documentation](/vault/docs/commands/operator/raft#snapshot-load).

After you start the snapshot load, you can check the snapshot loading status by reading the snapshot ID returned in the load output.

```shell-session
$ vault read \
    /sys/storage/raft/snapshot-load/37cc5b09-e6fb-4b2a-970b-dc8341af9cd0
```

Vault responds with snapshot details, including the status.

```plaintext
Key                                   Value
---                                   -----
auto_config_name                      zurich-secondary
cluster_id                            ce1862c4-c84d-4bb9-8579-079dcec3f892
expires_at                            2025-06-25T09:00:42.828919+00:00
snapshot_id                           37cc5b09-e6fb-4b2a-970b-dc8341af9cd0
status                                ready
```

When Vault loads the snapshot, the status value is `loading` until loading is complete, and the value changes to `ready` when you can use the snapshot for secret recovery.

If a problem occurs during loading, Vault sets the status to `error` and shares details about the problem.

<Note>

You can't recover secrets from a snapshot with an `error` status.

</Note>

#### Recover the secret

When the snapshot status is **ready**, you can recover the secret by specifying its path. 

Your Vault token must have the `recover` capability on a path to recover that path from a snapshot. For example to recover any secret on the path `development-lab`, your token needs an access control list policy like this example:

```hcl
path "development-lab/*" {
  capabilities = ["recover"]
}
```

In this example, recover the secret named `test-runner` from the key/value version 1 secrets engine enabled at the path `development-lab`.

```shell-session
$ vault read \
    -snapshot-id 37cc5b09-e6fb-4b2a-970b-dc8341af9cd0 \
    development-lab/test-runner
```

Vault reads the secret at the specified path from the snapshot, then sends that data to the secrets engine to recover the secret. The secrets engine uses this data potientally with its own information to create or update the data at the specified path in live cluster storage.

You can read the secret from its usual path in the secrets engine to test recovery.

```shell-session
$ vault kv get development-lab/test-runner
```

Vault responds with the secret data.

```plaintext
======= Data =======
Key           Value
---           -----
passphrase    guardant scanning dimmest bazaar macaroni tipoff
```

</Tab>

<Tab heading="API" group="api">

When you use Vault Enterprise with automated snapshots, you don't need to first transfer the snapshot file. You can load a snapshot that Vault saved to cloud storage directly from its URL. 

Create a JSON payload that defines the URL to the automated snapshot you need to load.

```shell-session
$ cat > payload.json << EOF
{
  "url": "https://bucket.example.com/vault-snapshots/secondary/zurich-backup.snap"
}
```

Load the snapshot that holds the secret you need to recover.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    --data @payload.json \
    https://127.0.0.1:8200/v1/sys/storage/raft/snapshot-auto/snapshot-load/zurich-secondary
```

Vault responds with snapshot details, including the status.

```json
{
  "data": {
    "auto_config_name": "zurich-secondary",
    "cluster_id": "ce1862c4-c84d-4bb9-8579-079dcec3f892",
    "expires_at": "2025-06-25T09:00:42.828919+00:00",
    "snapshot_id": "37cc5b09-E6FB-4b2a-970b-dc8341af9cd0",
    "url": "https://bucket.example.com/vault-snapshots/secondary/zurich-backup.snap",
    "status": "loading"
  }
}
```

After you start the snapshot load, you can check the snapshot loading status by reading the snapshot ID returned in the load output.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    http://127.0.0.1:8200/v1/sys/storage/raft/snapshot-load/37cc5b09-e6fb-4b2a-970b-dc8341af9cd0
```

Vault responds with snapshot details, including the status.

```json
{
  "data": {
    "auto_config_name": "zurich-secondary",
    "cluster_id": "ce1862c4-c84d-4bb9-8579-079dcec3f892",
    "expires_at": "2025-06-25T09:00:42.828919+00:00",
    "snapshot_id": "37cc5b09-e6fb-4b2a-970b-dc8341af9cd0",
    "url": "https://bucket.example.com/vault-snapshots/secondary/zurich-backup.snap",
    "status": "ready"
  }
}
```

When Vault loads the snapshot, the status value is `loading` until loading is complete, and the value changes to `ready` when you can use the snapshot for secret recovery.

If a problem occurs during loading, Vault sets the status to `error` and shares details about the problem.

<Note>

You can't recover secrets from a snapshot with an `error` status.

</Note>

#### Recover the secret

When the snapshot status is **ready**, you can recover the secret by specifying its path. 

Your Vault token must have the `recover` capability on a path to recover that path from a snapshot. For example to recover any secret on the path `development-lab`, your token needs an access control list policy like this example:

```hcl
path "development-lab/*" {
  capabilities = ["recover"]
}
```

In this example, recover the secret named `test-runner` from the key/value version 1 secrets engine enabled at the path `development-lab`.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request POST \
    https://127.0.0.1:8200/v1/development-lab/test-runner?recover_snapshot_id=37cc5b09-E6FB-4b2a-970b-dc8341af9cd0
```

Vault reads the secret at the specified path from the snapshot, then sends that data to the secrets engine to recover the secret. The secrets engine uses this data potientally with its own information to create or update the data at the specified path in live cluster storage.

You can read the secret from its usual path in the secrets engine to test recovery.

```shell-session
$ curl \
    --header "X-Vault-Token: ..." \
    --request GET \
    https://127.0.0.1:8200/v1/development-lab/test-runner
```

Vault responds with the secret data.

```json
{
    "request_id": "59d2b213-71fb-b5c2-8022-f6d14dab8d0c",
    "lease_id": "",
    "renewable": false,
    "lease_duration": 2764800,
    "data": {
        "passphrase": "guardant scanning dimmest bazaar macaroni tipoff"
    },
    "wrap_info": null,
    "warnings": null,
    "auth": null,
    "mount_type": "kv"
}
```

</Tab>

</Tabs>

</Tab>

</Tabs>
