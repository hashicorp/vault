---
layout: docs
page_title: pki health-check - Command
description: |-
  The "pki health-check" command verifies the health of the given PKI secrets
  engine mount against an optional configuration.
---

# pki health-check

Verifies the health of the given PKI secrets engine mount against an optional 
configuration.

<CodeBlockConfig hideClipboard>

```shell-session
$ vault pki health-check [flags] <mount>

$ vault pki health-check [-help | -h]
```

</CodeBlockConfig>

## Description

`pki health-check` reports the status of the specified mount against best 
practices and pending failures. This is an informative command and not all 
recommendations will apply to all mounts; consider using a configuration file 
to tune the executed health checks.

This command runs with the permissions of the given token, reading various APIs
from the mount and `/sys` against the given Vault server.

You need to specify the mount with any namespaces prefixed in the path, e.g.,
`ns1/pki`.

### Return status and output

This command returns the following exit codes:

| Exit code | Description |
| --- | --- |
| `0` | Everything is good. |
| `1` | Usage error (check CLI parameters). |
| `2` | Informational message from a health check. |
| `3` | Warning message from a health check. |
| `4` | Critical message from a health check. |
| `5` | A version mismatch between health check and Vault Server occurred, preventing one or more health checks from being fully run. |
| `6` | A permission denied message was returned from Vault Server for one or more health checks. |

A version mismatch (exit code `5`) does not necessarily mean the health check has failed completely. For example, when running the `crl_validity_period` health check against Vault 1.11, it will return an invalid version warning since Delta CRL is not supported in that version. However, it can still check the complete CRL successfully.

Each health check outputs one or more results in a list format. The results contain:

- `status`: A text description of the status
- `status_code`: A numeric code indicating the severity
- `endpoint`: The API endpoint that was checked
- `message`: Details about the result

An endpoint may appear in multiple health check results. Some endpoints may use wildcards to indicate the result applies to all matching paths. When results are displayed in table format, the status code is omitted since it's primarily meant for programmatic use.

The possible status values and their corresponding exit codes are:

| Status | Status Code | Exit Code |
|--------|-------------|-----------|
| `not_applicable` | 0 | 0 |
| `ok` | 1 | 0 |
| `informational` | 2 | 2 |
| `warning` | 3 | 3 |
| `critical` | 4 | 4 |
| `invalid_version` | 5 | 5 |
| `insufficient_permissions` | 6 | 6 |

## Command arguments

<br />

@include 'cli/pki/args/mount.mdx'

## Command options

None.

## Command flags

<br />

@include 'cli/pki/flags/default-disabled.mdx'

<br /><hr /><br />

@include 'cli/pki/flags/health-config.mdx'

<br /><hr /><br />

@include 'cli/pki/flags/list.mdx'

<br /><hr /><br />

@include 'cli/pki/flags/return-indicator.mdx'

## Global flags

<br />

@include 'cli/standard-settings/all-standard-flags.mdx'

## Examples

Performs a basic health check against the `pki-root` mount:

```shell-session
$ vault pki health-check pki-root/
```

Configuration can be specified using the `-health-config` flag:

```shell-session
$ vault pki health-check -health-config=mycorp-root.json pki-root/
```

Using the `-list` flag will show the list of health checks and any
known configuration values (with their defaults) that will be run
against this mount:

```shell-session
$ vault pki health-check -list pki-root/
```