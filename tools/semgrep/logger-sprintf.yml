# Copyright (c) HashiCorp, Inc.
# SPDX-License-Identifier: BUSL-1.1

rules:
  - id: logger-used-with-sprintf
    patterns:
      - pattern-either:
        - pattern: |
            logger.Trace(fmt.Sprintf(...))
        - pattern: |
            logger.Debug(fmt.Sprintf(...))
        - pattern: |
            logger.Info(fmt.Sprintf(...))
        - pattern: |
            logger.Warn(fmt.Sprintf(...))
        - pattern: |
            logger.Error(fmt.Sprintf(...))
        - pattern: |
            $PARENT.logger.Trace(fmt.Sprintf(...))
        - pattern: |
            $PARENT.logger.Debug(fmt.Sprintf(...))
        - pattern: |
            $PARENT.logger.Info(fmt.Sprintf(...))
        - pattern: |
            $PARENT.logger.Warn(fmt.Sprintf(...))
        - pattern: |
            $PARENT.logger.Error(fmt.Sprintf(...))
    message: "Logger message generated by Sprintf"
    languages: [go]
    severity: WARNING
  
    
