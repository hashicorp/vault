{{!
  Copyright (c) HashiCorp, Inc.
  SPDX-License-Identifier: BUSL-1.1
}}

<Messages::TabPageHeader
  @authenticated={{@message.authenticated}}
  @pageTitle={{@message.title}}
  @breadcrumbs={{@breadcrumbs}}
/>

<Toolbar>
  <ToolbarActions aria-label="message delete and edit">
    {{#if @capabilities.canDelete}}
      <ConfirmAction
        class="toolbar-button"
        @buttonColor="secondary"
        @onConfirmAction={{this.deleteMessage}}
        @confirmTitle="Are you sure?"
        @confirmMessage="This will delete this message permanently. You cannot undo this action."
        @buttonText="Delete message"
        data-test-confirm-action="Delete message"
      />
      <div class="toolbar-separator"></div>
    {{/if}}
    {{#if @capabilities.canUpdate}}
      <LinkTo class="toolbar-link" @route="messages.message.edit" @model={{@message.id}} data-test-link="edit">
        Edit message
        <Icon @name="chevron-right" />
      </LinkTo>
    {{/if}}
  </ToolbarActions>
</Toolbar>

{{#each this.orderedKeys as |key|}}
  {{#if (or (eq key "endTime") (eq key "startTime"))}}
    {{! if the attr is an endTime and is falsy, we want to show a 'Never' text value }}
    <InfoTableRow
      @label={{capitalize (humanize (dasherize key))}}
      @value={{if
        (and (eq key "endTime") (not (get @message key)))
        "Never"
        (date-format (get @message key) "MMM d, yyyy hh:mm aaa" withTimeZone=true)
      }}
    />
  {{else if (eq key "link")}}
    {{#if (is-empty-value @message.link)}}
      <InfoTableRow @label="Link" @value="None" />
    {{else}}
      {{#each-in @message.link as |title href|}}
        <InfoTableRow @label="Link" @value={{title}}>
          <Hds::Link::Inline @icon="external-link" @href={{href}} data-test-link="message link">{{title}}</Hds::Link::Inline>
        </InfoTableRow>
      {{/each-in}}
    {{/if}}
  {{else}}
    <InfoTableRow @label={{capitalize (humanize (dasherize key))}} @value={{get @message key}} />
  {{/if}}

{{/each}}