{{!
  Copyright (c) HashiCorp, Inc.
  SPDX-License-Identifier: BUSL-1.1
}}
<div ...attributes>
  {{#if @readOnly}}
    <Hds::CodeBlock @hasCopyButton={{true}} @language={{@mode}} @value={{or @value @example}} as |CB|>
      {{#if @title}}
        <CB.Title data-test-component="json-editor-title">
          {{@title}}
        </CB.Title>
      {{/if}}

      {{#if @helpText}}
        <CB.Description>
          {{@helpText}}
        </CB.Description>
      {{/if}}
    </Hds::CodeBlock>
  {{else}}
    <Hds::CodeEditor
      data-test-component="code-mirror-modifier"
      @ariaLabel={{this.ariaLabel}}
      @extraKeys={{@extraKeys}}
      @language={{@mode}}
      @value={{or @value @example}}
      @onBlur={{@onBlur}}
      @onInput={{this.onUpdate}}
      @onSetup={{fn (mut this._codemirrorEditor)}}
      as |CE|
    >
      {{#if this.getShowToolbar}}
        <div data-test-component="json-editor-toolbar">
          {{#if @title}}
            <CE.Title data-test-component="json-editor-title">
              {{@title}}
            </CE.Title>
          {{/if}}

          {{#if @subTitle}}
            <CE.Description>
              {{@subTitle}}
            </CE.Description>
          {{/if}}

          {{#if @helpText}}
            <CE.Description>
              {{@helpText}}
            </CE.Description>
          {{/if}}

          <CE.Generic>
            {{yield}}

            {{#if @example}}
              <Hds::Button
                class="toolbar-button"
                @icon="reload"
                @text="Restore example"
                disabled={{not @value}}
                {{on "click" this.restoreExample}}
                data-test-restore-example
              />
            {{/if}}

            <div class="toolbar-separator"></div>

            <Hds::Copy::Button
              @container={{@container}}
              @text="Copy"
              @isIconOnly={{true}}
              @textToCopy={{@value}}
              @onError={{(fn
                (set-flash-message "Clipboard copy failed. The Clipboard API requires a secure context." "danger")
              )}}
              class="transparent"
              data-test-copy-button={{@value}}
            />
          </CE.Generic>
        </div>
      {{/if}}
    </Hds::CodeEditor>
  {{/if}}
</div>